{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport TouchableWithoutFeedback from \"react-native-web/dist/exports/TouchableWithoutFeedback\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport firebase from \"firebase/compat/app\";\nimport \"firebase/compat/auth\";\nimport \"firebase/compat/firestore\";\nimport * as Facebook from 'expo-facebook';\nimport * as Google from 'expo-google-app-auth';\nimport * as GoogleSignIn from 'expo-google-sign-in';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar SignInScreen = function (_React$Component) {\n  _inherits(SignInScreen, _React$Component);\n\n  var _super = _createSuper(SignInScreen);\n\n  function SignInScreen() {\n    var _this;\n\n    _classCallCheck(this, SignInScreen);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      email: '',\n      password: '',\n      errorMessage: '',\n      loading: false\n    };\n\n    _this.isUserEqual = function (googleUser, firebaseUser) {\n      if (firebaseUser) {\n        var providerData = firebaseUser.providerData;\n\n        for (var i = 0; i < providerData.length; i++) {\n          if (providerData[i].providerId === firebase.auth.GoogleAuthProvider.PROVIDER_ID && providerData[i].uid === googleUser.getBasicProfile().getId()) {\n            return true;\n          }\n        }\n      }\n\n      return false;\n    };\n\n    _this.onSignIn = function (googleUser) {\n      console.log('Google Auth Response', googleUser);\n      var unsubscribe = firebase.auth().onAuthStateChanged(function (firebaseUser) {\n        unsubscribe();\n\n        if (!this.isUserEqual(googleUser, firebaseUser)) {\n          var credential = firebase.auth.GoogleAuthProvider.credential(googleUser.idToken, googleUser.accessToken);\n          firebase.auth().signInAndRetrieveDataWithCredential(credential).then(function (result) {\n            console.log(\"user sign in\");\n            firebase.database().ref('/users' + result.user.uid).set({\n              gmail: result.user.email,\n              profile_picture: result.additionalUserInfo.profile.profile_picture,\n              locale: result.additionalUserInfo.profile_picture.locale,\n              first_name: result.additionalUserInfo.given_name,\n              last_name: result.additionalUserInfo.first_name\n            }).then(function (snapshot) {});\n          }).catch(function (error) {\n            var errorCode = error.code;\n            var errorMessage = error.message;\n            var email = error.email;\n            var credential = error.credential;\n          });\n        } else {\n          console.log('User already signed-in Firebase.');\n        }\n      }.bind(_assertThisInitialized(_this)));\n    };\n\n    _this.signInWithGoogleAsync = function _callee() {\n      var result;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(Google.logInAsync({\n                behavior: 'web',\n                webClientId: '731109863491-b5981s6u228m4f4t8l1lliceqstgahkq.apps.googleusercontent.com',\n                iosClientId: '731109863491-77g059lagdgbkmpoph4497904en22u2o.apps.googleusercontent.com',\n                scopes: ['profile', 'email']\n              }));\n\n            case 3:\n              result = _context.sent;\n\n              if (!(result.type === 'success')) {\n                _context.next = 9;\n                break;\n              }\n\n              _this.onSignIn(result);\n\n              return _context.abrupt(\"return\", result.accessToken);\n\n            case 9:\n              return _context.abrupt(\"return\", {\n                cancelled: true\n              });\n\n            case 10:\n              _context.next = 15;\n              break;\n\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](0);\n              return _context.abrupt(\"return\", {\n                error: true\n              });\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, [[0, 12]], Promise);\n    };\n\n    return _this;\n  }\n\n  _createClass(SignInScreen, [{\n    key: \"onLoginSuccess\",\n    value: function onLoginSuccess() {\n      this.props.navigation.navigate('App');\n    }\n  }, {\n    key: \"onLoginFailure\",\n    value: function onLoginFailure(errorMessage) {\n      this.setState({\n        error: errorMessage,\n        loading: false\n      });\n    }\n  }, {\n    key: \"renderLoading\",\n    value: function renderLoading() {\n      if (this.state.loading) {\n        return _jsx(View, {\n          children: _jsx(ActivityIndicator, {\n            size: 'large'\n          })\n        });\n      }\n    }\n  }, {\n    key: \"signInWithEmail\",\n    value: function signInWithEmail() {\n      var _this2 = this;\n\n      return _regeneratorRuntime.async(function signInWithEmail$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _regeneratorRuntime.awrap(firebase.auth().signInWithEmailAndPassword(this.state.email, this.state.password).then(this.onLoginSuccess.bind(this)).catch(function (error) {\n                var errorCode = error.code;\n                var errorMessage = error.message;\n\n                if (errorCode == 'auth/weak-password') {\n                  _this2.onLoginFailure.bind(_this2)('Weak Password!');\n                } else {\n                  _this2.onLoginFailure.bind(_this2)(errorMessage);\n                }\n              }));\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }, {\n    key: \"signInWithFacebook\",\n    value: function signInWithFacebook() {\n      var _await$Facebook$logIn, type, token, credential, facebookProfileData, message;\n\n      return _regeneratorRuntime.async(function signInWithFacebook$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              _context3.next = 3;\n              return _regeneratorRuntime.awrap(Facebook.logInWithReadPermissionsAsync('337956678166688', {\n                permissions: ['public_profile']\n              }));\n\n            case 3:\n              _await$Facebook$logIn = _context3.sent;\n              type = _await$Facebook$logIn.type;\n              token = _await$Facebook$logIn.token;\n\n              if (!(type === 'success')) {\n                _context3.next = 14;\n                break;\n              }\n\n              _context3.next = 9;\n              return _regeneratorRuntime.awrap(firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL));\n\n            case 9:\n              credential = firebase.auth.FacebookAuthProvider.credential(token);\n              _context3.next = 12;\n              return _regeneratorRuntime.awrap(firebase.auth().signInWithCredential(credential));\n\n            case 12:\n              facebookProfileData = _context3.sent;\n              this.onLoginSuccess.bind(this);\n\n            case 14:\n              _context3.next = 20;\n              break;\n\n            case 16:\n              _context3.prev = 16;\n              _context3.t0 = _context3[\"catch\"](0);\n              message = _context3.t0.message;\n              alert(\"Facebook Login Error: \" + message);\n\n            case 20:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, this, [[0, 16]], Promise);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return _jsx(TouchableWithoutFeedback, {\n        onPress: function onPress() {\n          Keyboard.dismiss();\n        },\n        children: _jsx(SafeAreaView, {\n          style: {\n            flex: 1\n          },\n          children: _jsxs(KeyboardAvoidingView, {\n            style: styles.container,\n            behavior: \"padding\",\n            children: [_jsx(Text, {\n              style: {\n                fontSize: 32,\n                fontWeight: \"700\",\n                color: \"gray\"\n              },\n              children: \"Login In\"\n            }), _jsxs(View, {\n              style: styles.form,\n              children: [_jsx(TextInput, {\n                style: styles.input,\n                placeholder: \"Email\",\n                placeholderTextColor: \"#B1B1B1\",\n                returnKeyType: \"next\",\n                keyboardType: \"email-address\",\n                textContentType: \"emailAddress\",\n                value: this.state.email,\n                onChangeText: function onChangeText(email) {\n                  return _this3.setState({\n                    email: email\n                  });\n                }\n              }), _jsx(TextInput, {\n                style: styles.input,\n                placeholder: \"Password\",\n                placeholderTextColor: \"#B1B1B1\",\n                returnKeyType: \"done\",\n                textContentType: \"newPassword\",\n                secureTextEntry: true,\n                value: this.state.password,\n                onChangeText: function onChangeText(password) {\n                  return _this3.setState({\n                    password: password\n                  });\n                }\n              })]\n            }), this.renderLoading(), _jsx(Text, {\n              style: {\n                fontSize: 18,\n                textAlign: \"center\",\n                color: \"red\",\n                width: \"80%\"\n              },\n              children: this.state.error\n            }), _jsx(TouchableOpacity, {\n              style: {\n                width: '20%',\n                marginTop: 20\n              },\n              onPress: function onPress() {\n                return _this3.signInWithEmail();\n              },\n              children: _jsx(Text, {\n                children: \"Sign In\"\n              })\n            }), _jsx(TouchableOpacity, {\n              style: {\n                width: '86%',\n                marginTop: 10\n              },\n              onPress: function onPress() {\n                return _this3.signInWithFacebook();\n              },\n              children: _jsx(View, {\n                style: styles.button,\n                children: _jsx(Text, {\n                  style: {\n                    letterSpacing: 0.5,\n                    fontSize: 16,\n                    color: '#FFFFFF'\n                  },\n                  children: \"Continue with Facebook\"\n                })\n              })\n            }), _jsx(TouchableOpacity, {\n              style: {\n                width: '86%',\n                marginTop: 10\n              },\n              onPress: function onPress() {\n                return _this3.signInWithGoogleAsync();\n              },\n              children: _jsx(View, {\n                style: styles.googleButton,\n                children: _jsx(Text, {\n                  style: {\n                    letterSpacing: 0.5,\n                    fontSize: 16,\n                    color: '#707070'\n                  },\n                  children: \"Continue with Google\"\n                })\n              })\n            }), _jsx(View, {\n              style: {\n                marginTop: 10\n              },\n              children: _jsx(Text, {\n                style: {\n                  fontWeight: \"200\",\n                  fontSize: 17,\n                  textAlign: \"center\"\n                },\n                onPress: function onPress() {\n                  _this3.props.navigation.navigate(\"SignUp\");\n                },\n                children: \"Don't have an Account? Sign Up\"\n              })\n            })]\n          })\n        })\n      });\n    }\n  }]);\n\n  return SignInScreen;\n}(React.Component);\n\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    flexDirection: \"column\",\n    alignItems: \"center\"\n  },\n  form: {\n    width: \"86%\",\n    marginTop: 15\n  },\n  logo: {\n    marginTop: 20\n  },\n  input: {\n    fontSize: 20,\n    borderColor: \"#707070\",\n    borderBottomWidth: 1,\n    paddingBottom: 1.5,\n    marginTop: 25.5\n  },\n  button: {\n    backgroundColor: \"#3A559F\",\n    height: 44,\n    flexDirection: \"row\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    borderRadius: 22\n  },\n  googleButton: {\n    backgroundColor: \"#FFFFFF\",\n    height: 44,\n    flexDirection: \"row\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    borderRadius: 22,\n    borderWidth: 1,\n    borderColor: \"#707070\"\n  }\n});\nexport default SignInScreen;","map":{"version":3,"sources":["C:/Users/Dell/Desktop/REACT/ThirdTest/secondTest/screens/SignInScreen.js"],"names":["React","firebase","Facebook","Google","GoogleSignIn","SignInScreen","state","email","password","errorMessage","loading","isUserEqual","googleUser","firebaseUser","providerData","i","length","providerId","auth","GoogleAuthProvider","PROVIDER_ID","uid","getBasicProfile","getId","onSignIn","console","log","unsubscribe","onAuthStateChanged","credential","idToken","accessToken","signInAndRetrieveDataWithCredential","then","result","database","ref","user","set","gmail","profile_picture","additionalUserInfo","profile","locale","first_name","given_name","last_name","snapshot","catch","error","errorCode","code","message","bind","signInWithGoogleAsync","logInAsync","behavior","webClientId","iosClientId","scopes","type","cancelled","props","navigation","navigate","setState","signInWithEmailAndPassword","onLoginSuccess","onLoginFailure","logInWithReadPermissionsAsync","permissions","token","setPersistence","Auth","Persistence","LOCAL","FacebookAuthProvider","signInWithCredential","facebookProfileData","alert","Keyboard","dismiss","flex","styles","container","fontSize","fontWeight","color","form","input","renderLoading","textAlign","width","marginTop","signInWithEmail","signInWithFacebook","button","letterSpacing","googleButton","Component","StyleSheet","create","flexDirection","alignItems","logo","borderColor","borderBottomWidth","paddingBottom","backgroundColor","height","justifyContent","borderRadius","borderWidth"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport {\r\n  StyleSheet,\r\n  View,\r\n  Text,\r\n  TextInput,\r\n  SafeAreaView,\r\n  TouchableOpacity,\r\n  KeyboardAvoidingView,\r\n  ActivityIndicator,\r\n  TouchableWithoutFeedback,\r\n  Keyboard\r\n} from \"react-native\";\r\n\r\nimport firebase from \"firebase/compat/app\"\r\nimport \"firebase/compat/auth\"\r\nimport \"firebase/compat/firestore\"\r\nimport * as Facebook from 'expo-facebook'\r\nimport * as Google from 'expo-google-app-auth';\r\nimport * as GoogleSignIn from 'expo-google-sign-in';\r\n// import {\r\n//   FACEBOOK_APP_ID,\r\n//   ANDROID_CLIENT_ID,\r\n//   IOS_CLIENT_ID\r\n// } from 'react-native-dotenv'\r\n\r\n// const facebookAppId = {\r\n//   FACEBOOK_APP_ID\r\n// }\r\n// const androidClientId = {\r\n//   ANDROID_CLIENT_ID,\r\n\r\n// }\r\n// const IOSClientId = {\r\n//   IOS_CLIENT_ID\r\n// }\r\n\r\n\r\nclass SignInScreen extends React.Component {\r\n  state = { email: '', password: '', errorMessage: '', loading: false };\r\n  onLoginSuccess() {\r\n    this.props.navigation.navigate('App');\r\n  }\r\n  onLoginFailure(errorMessage) {\r\n    this.setState({ error: errorMessage, loading: false });\r\n  }\r\n  renderLoading() {\r\n    if (this.state.loading) {\r\n      return (\r\n        <View>\r\n          <ActivityIndicator size={'large'} />\r\n        </View>\r\n      );\r\n    }\r\n  }\r\n  async signInWithEmail() {\r\n    await firebase\r\n      .auth()\r\n      .signInWithEmailAndPassword(this.state.email, this.state.password)\r\n      .then(this.onLoginSuccess.bind(this))\r\n      .catch(error => {\r\n          let errorCode = error.code;\r\n          let errorMessage = error.message;\r\n          if (errorCode == 'auth/weak-password') {\r\n              this.onLoginFailure.bind(this)('Weak Password!');\r\n          } else {\r\n              this.onLoginFailure.bind(this)(errorMessage);\r\n          }\r\n      });\r\n  }\r\n  // async signInWithFacebook() {\r\n  //   try {\r\n  //     const { type, token } = await Facebook.logInWithReadPermissionsAsync('337956678166688', {\r\n  //       permissions: ['public_profile'],\r\n  //     });\r\n  //     if (type === 'success') {\r\n  //       await firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL);\r\n  //       const credential = firebase.auth.FacebookAuthProvider.credential(token);\r\n  //       const facebookProfileData = await firebase.auth().signInWithCredential(credential);\r\n  //       this.onLoginSuccess.bind(this)\r\n  //     }\r\n  //   } catch ({ message }) {\r\n  //     alert(`Facebook Login Error: ${message}`);\r\n  //   }\r\n  // }\r\n\r\n\r\n  // async signInWithGoogle() {\r\n  //   try {\r\n  //     const result = await Google.logInAsync({\r\n  //       // androidClientId: androidClientId,\r\n  //       // iosClientId: IOSClientId,\r\n  //       behavior: 'web',\r\n  //       iosClientId: '731109863491-77g059lagdgbkmpoph4497904en22u2o.apps.googleusercontent.com', //enter ios client id\r\n  //       scopes: ['profile', 'email']\r\n  //     });\r\n      \r\n  //     if (result.type  === 'success') {\r\n  //       await firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL);\r\n  //       const credential = firebase.auth.GoogleAuthProvider.credential(result.idToken, result.accessToken);\r\n  //       const googleProfileData = await firebase.auth().signInWithCredential(credential);\r\n  //       this.onLoginSuccess.bind(this);\r\n  //     }\r\n  //   } catch ({ message }) {\r\n  //     alert('login: Error:' + message);\r\n  //     console.log(message);\r\n  //   }\r\n  // }\r\n\r\n  async signInWithFacebook() {\r\n    try {\r\n      const { type, token } = await Facebook.logInWithReadPermissionsAsync('337956678166688', {\r\n        permissions: ['public_profile'],\r\n      });\r\n      if (type === 'success') {\r\n        await firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL);\r\n        const credential = firebase.auth.FacebookAuthProvider.credential(token);\r\n        const facebookProfileData = await firebase.auth().signInWithCredential(credential);\r\n        this.onLoginSuccess.bind(this);\r\n      }\r\n    } catch ({ message }) {\r\n      alert(`Facebook Login Error: ${message}`);\r\n    }\r\n  }\r\n\r\n   isUserEqual = (googleUser, firebaseUser) => {\r\n    if (firebaseUser) {\r\n      var providerData = firebaseUser.providerData;\r\n      for (var i = 0; i < providerData.length; i++) {\r\n        if (providerData[i].providerId === firebase.auth.GoogleAuthProvider.PROVIDER_ID &&\r\n            providerData[i].uid === googleUser.getBasicProfile().getId()) {\r\n          // We don't need to reauth the Firebase connection.\r\n          return true;\r\n        }\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n   onSignIn = (googleUser)  => {\r\n    console.log('Google Auth Response', googleUser);\r\n    // We need to register an Observer on Firebase Auth to make sure auth is initialized.\r\n    var unsubscribe = firebase.auth().onAuthStateChanged(function(firebaseUser) {\r\n      unsubscribe();\r\n      // Check if we are already signed-in Firebase with the correct user.\r\n      if (!this.isUserEqual(googleUser, firebaseUser)) {\r\n        // Build Firebase credential with the Google ID token.\r\n        var credential = firebase.auth.GoogleAuthProvider.credential(\r\n            googleUser.idToken,\r\n            googleUser.accessToken);\r\n        // Sign in with credential from the Google user.\r\n        firebase.auth().signInAndRetrieveDataWithCredential(credential).then(function(result){\r\n            \r\n            console.log(\"user sign in\");\r\n        firebase\r\n        .database()\r\n        .ref('/users'+result.user.uid)\r\n        .set({\r\n            gmail:result.user.email,\r\n            profile_picture:result.additionalUserInfo.profile.profile_picture,\r\n            locale:result.additionalUserInfo.profile_picture.locale,\r\n            first_name:result.additionalUserInfo.given_name,\r\n            last_name:result.additionalUserInfo.first_name\r\n        })\r\n        .then(function(snapshot){\r\n\r\n        });\r\n        }).catch(function(error) {\r\n          // Handle Errors here.\r\n          var errorCode = error.code;\r\n          var errorMessage = error.message;\r\n          // The email of the user's account used.\r\n          var email = error.email;\r\n          // The firebase.auth.AuthCredential type that was used.\r\n          var credential = error.credential;\r\n          // ...\r\n        });\r\n      } else {\r\n        console.log('User already signed-in Firebase.');\r\n      }\r\n    }.bind(this));\r\n  }\r\n  signInWithGoogleAsync = async () => {\r\n    try {\r\n      const result = await Google.logInAsync({\r\n        // androidClientId: androidClientId,\r\n        // iosClientId: IOSClientId,\r\n        behavior: 'web',\r\n        webClientId:'731109863491-b5981s6u228m4f4t8l1lliceqstgahkq.apps.googleusercontent.com',\r\n        iosClientId: '731109863491-77g059lagdgbkmpoph4497904en22u2o.apps.googleusercontent.com', //enter ios client id\r\n        scopes: ['profile', 'email']\r\n      });\r\n\r\n      if (result.type === 'success') {\r\n        this.onSignIn(result);\r\n        return result.accessToken;\r\n      } else {\r\n        return { cancelled: true };\r\n      }\r\n    } catch (e) {\r\n      return { error: true };\r\n    }\r\n  };\r\n\r\n\r\n\r\n\r\n  render() {\r\n    return (\r\n      <TouchableWithoutFeedback\r\n        onPress={() => {\r\n          Keyboard.dismiss();\r\n        }}\r\n      >\r\n        <SafeAreaView style={{ flex: 1 }}>\r\n          <KeyboardAvoidingView style={styles.container} behavior=\"padding\">\r\n            <Text style={{ fontSize: 32, fontWeight: \"700\", color: \"gray\" }}>\r\n              Login In\r\n            </Text>\r\n            <View style={styles.form}>\r\n              <TextInput\r\n                style={styles.input}\r\n                placeholder=\"Email\"\r\n                placeholderTextColor=\"#B1B1B1\"\r\n                returnKeyType=\"next\"\r\n                keyboardType=\"email-address\"\r\n                textContentType=\"emailAddress\"\r\n                value={this.state.email}\r\n                onChangeText={email => this.setState({ email })}\r\n              />\r\n              <TextInput\r\n                style={styles.input}\r\n                placeholder=\"Password\"\r\n                placeholderTextColor=\"#B1B1B1\"\r\n                returnKeyType=\"done\"\r\n                textContentType=\"newPassword\"\r\n                secureTextEntry={true}\r\n                value={this.state.password}\r\n                onChangeText={password => this.setState({ password })}\r\n              />\r\n            </View>\r\n            {this.renderLoading()}\r\n            <Text\r\n              style={{\r\n                fontSize: 18,\r\n                textAlign: \"center\",\r\n                color: \"red\",\r\n                width: \"80%\"\r\n              }}\r\n            >\r\n              {this.state.error}\r\n            </Text>\r\n            <TouchableOpacity\r\n              style={{ width: '20%', marginTop: 20  }}\r\n              onPress={() => this.signInWithEmail()}>\r\n                  <Text>Sign In</Text>\r\n            </TouchableOpacity>\r\n             <TouchableOpacity\r\n              style={{ width: '86%', marginTop: 10 }}\r\n              onPress={() => this.signInWithFacebook()}>\r\n              <View style={styles.button}>\r\n                <Text\r\n                  style={{\r\n                    letterSpacing: 0.5,\r\n                    fontSize: 16,\r\n                    color: '#FFFFFF'\r\n                  }}\r\n                >\r\n                  Continue with Facebook\r\n                </Text>\r\n              </View>\r\n            </TouchableOpacity>\r\n            <TouchableOpacity \r\n              style={{ width: '86%', marginTop: 10 }}\r\n              onPress={() => this.signInWithGoogleAsync()}>\r\n              <View style={styles.googleButton}>\r\n                <Text\r\n                  style={{\r\n                    letterSpacing: 0.5,\r\n                    fontSize: 16,\r\n                    color: '#707070'\r\n                  }}\r\n                >\r\n                  Continue with Google\r\n                </Text>\r\n              </View>\r\n            </TouchableOpacity> \r\n            <View style={{ marginTop: 10 }}>\r\n              <Text\r\n                style={{ fontWeight: \"200\", fontSize: 17, textAlign: \"center\" }}\r\n                onPress={() => {\r\n                  this.props.navigation.navigate(\"SignUp\");\r\n                }}\r\n              >\r\n                Don't have an Account?\r\n                        Sign Up\r\n              </Text>\r\n            </View>\r\n          </KeyboardAvoidingView>\r\n        </SafeAreaView>\r\n      </TouchableWithoutFeedback>\r\n    );\r\n  }\r\n}\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    flexDirection: \"column\",\r\n    alignItems: \"center\"\r\n  },\r\n  form: {\r\n    width: \"86%\",\r\n    marginTop: 15\r\n  },\r\n  logo: {\r\n    marginTop: 20\r\n  },\r\n  input: {\r\n    fontSize: 20,\r\n    borderColor: \"#707070\",\r\n    borderBottomWidth: 1,\r\n    paddingBottom: 1.5,\r\n    marginTop: 25.5\r\n  },\r\n  button: {\r\n    backgroundColor: \"#3A559F\",\r\n    height: 44,\r\n    flexDirection: \"row\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    borderRadius: 22\r\n  },\r\n  googleButton: {\r\n    backgroundColor: \"#FFFFFF\",\r\n    height: 44,\r\n    flexDirection: \"row\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    borderRadius: 22,\r\n    borderWidth: 1,\r\n    borderColor: \"#707070\"\r\n  }\r\n});\r\nexport default SignInScreen;"]},"metadata":{},"sourceType":"module"}